/* ===== FIXES UNIVERSALES PARA PREVENIR OVERFLOW ===== */

/* Reset base más estricto */
*, *::before, *::after {
  box-sizing: border-box;
  max-width: 100%;
}

html {
  overflow-x: hidden;
  width: 100%;
}

body {
  overflow-x: hidden;
  width: 100%;
  margin: 0;
  padding: 0;
}

/* ===== CONTENEDORES PRINCIPALES ===== */
.gantt-page,
.actividades-page {
  width: 100vw;
  max-width: 100vw;
  overflow-x: hidden;
  position: relative;
}

/* ===== FIXES ESPECÍFICOS PARA GANTT ===== */

/* Header Gantt - Mejora responsive */
.gantt-header {
  width: 100%;
  max-width: 100vw;
  box-sizing: border-box;
  padding: 0.75rem min(1rem, 2vw);
}

.gantt-header-content {
  max-width: 100%;
  overflow: hidden;
  flex-wrap: wrap;
  gap: min(1rem, 2vw);
}

.gantt-header-left {
  min-width: 0;
  max-width: 100%;
  overflow: hidden;
}

.gantt-title {
  max-width: 100%;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.gantt-header-actions {
  max-width: 100%;
  flex-wrap: wrap;
  justify-content: center;
  gap: 0.5rem;
}

/* Panel izquierdo Gantt - Responsive mejorado */
.gantt-left-panel {
  width: min(300px, 35vw);
  min-width: min(280px, 30vw);
  max-width: min(320px, 40vw);
}

/* Timeline optimizado */
.gantt-timeline-weeks {
  overflow-x: auto;
  overflow-y: hidden;
  -webkit-overflow-scrolling: touch;
}

.gantt-timeline-content {
  overflow-x: auto;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
  width: 100%;
}

/* ===== FIXES ESPECÍFICOS PARA ACTIVIDADES ===== */

/* Header Actividades */
.actividades-header {
  width: 100%;
  max-width: 100vw;
  overflow-x: hidden;
}

.header-container {
  max-width: min(1400px, 100vw);
  padding: 0 min(2rem, 4vw);
  width: 100%;
  box-sizing: border-box;
}

.header-content {
  width: 100%;
  max-width: 100%;
  overflow: hidden;
  flex-wrap: wrap;
  gap: min(1.5rem, 3vw);
}

.header-left {
  min-width: 0;
  max-width: 100%;
  overflow: hidden;
}

.main-title {
  max-width: 100%;
  overflow: hidden;
  text-overflow: ellipsis;
  word-wrap: break-word;
  hyphens: auto;
}

.header-actions {
  flex-wrap: wrap;
  max-width: 100%;
  gap: min(1rem, 2vw);
}

/* Container principal */
.actividades-container {
  max-width: min(1400px, 100vw);
  width: 100%;
  padding: 2.5rem min(2rem, 4vw);
  box-sizing: border-box;
}

/* Grid de estadísticas */
.stats-grid-modern {
  width: 100%;
  max-width: 100%;
  overflow: hidden;
  grid-template-columns: repeat(auto-fit, minmax(min(280px, calc(100vw - 4rem)), 1fr));
  gap: min(1.5rem, 3vw);
}

.stat-card-modern {
  width: 100%;
  max-width: 100%;
  overflow: hidden;
  box-sizing: border-box;
}

/* Búsqueda */
.search-section {
  width: 100%;
  max-width: 100%;
  overflow: hidden;
  box-sizing: border-box;
}

.search-content {
  width: 100%;
  max-width: 100%;
  overflow: hidden;
  flex-wrap: wrap;
  gap: min(1.5rem, 3vw);
}

.search-input-container {
  width: 100%;
  max-width: 100%;
  min-width: 0;
}

.search-input {
  width: 100%;
  max-width: 100%;
  box-sizing: border-box;
}

.filter-group-horizontal {
  width: 100%;
  max-width: 100%;
  flex-wrap: wrap;
  gap: min(1rem, 2vw);
}

.filter-select-modern,
.date-input-modern {
  max-width: 100%;
  min-width: min(200px, 100%);
  box-sizing: border-box;
}

/* Grid de actividades */
.activities-grid {
  width: 100%;
  max-width: 100%;
  overflow: hidden;
  grid-template-columns: repeat(auto-fill, minmax(min(380px, calc(100vw - 4rem)), 1fr));
  gap: min(2rem, 3vw);
}

.activity-card-modern {
  width: 100%;
  max-width: 100%;
  overflow: hidden;
  box-sizing: border-box;
}

/* Tabla de actividades */
.activities-table-container {
  width: 100%;
  max-width: 100%;
  overflow: hidden;
  box-sizing: border-box;
}

.activities-table-wrapper {
  width: 100%;
  overflow-x: auto;
  overflow-y: visible;
  -webkit-overflow-scrolling: touch;
}

.activities-table {
  width: 100%;
  min-width: min(800px, 100vw);
}

/* ===== RESPONSIVE MEJORADO ===== */

/* Tablets grandes */
@media (max-width: 1200px) {
  .gantt-left-panel {
    width: min(280px, 30vw);
    min-width: min(260px, 25vw);
  }
  
  .stats-grid-modern {
    grid-template-columns: repeat(auto-fit, minmax(min(250px, calc(100vw - 3rem)), 1fr));
  }
  
  .activities-grid {
    grid-template-columns: repeat(auto-fill, minmax(min(350px, calc(100vw - 3rem)), 1fr));
  }
  
  .header-container,
  .actividades-container {
    padding: 0 min(1.5rem, 3vw);
  }
  
  .actividades-container {
    padding: 2.5rem min(1.5rem, 3vw);
  }
}

/* Tablets */
@media (max-width: 1024px) {
  .gantt-header {
    padding: 0.75rem min(1rem, 2vw);
  }
  
  .gantt-left-panel {
    width: min(260px, 25vw);
    min-width: min(240px, 20vw);
  }
  
  .header-content {
    flex-direction: column;
    align-items: stretch;
    gap: min(2rem, 4vw);
  }
  
  .header-actions {
    justify-content: center;
    flex-wrap: wrap;
  }
  
  .stats-grid-modern {
    grid-template-columns: repeat(2, 1fr);
    gap: min(1.5rem, 3vw);
  }
  
  .activities-grid {
    grid-template-columns: repeat(auto-fill, minmax(min(300px, calc(100vw - 3rem)), 1fr));
  }
  
  .search-content {
    flex-direction: column;
  }
  
  .filter-group-horizontal {
    justify-content: stretch;
  }
  
  .filter-select-modern,
  .date-input-modern {
    flex: 1;
    min-width: auto;
  }
}

/* Móviles grandes */
@media (max-width: 768px) {
  .gantt-page {
    height: 100vh;
    height: 100dvh;
  }
  
  .gantt-header {
    padding: 0.5rem min(1rem, 2vw);
  }
  
  .gantt-left-panel {
    position: fixed;
    left: -100%;
    width: min(280px, 80vw);
    z-index: 200;
    transition: left 0.3s ease;
    box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
  }
  
  .gantt-left-panel--open {
    left: 0;
  }
  
  .header-container {
    padding: 0 min(1rem, 2vw);
  }
  
  .actividades-container {
    padding: 1.5rem min(1rem, 2vw);
  }
  
  .main-title {
    font-size: clamp(1.5rem, 5vw, 2rem);
  }
  
  .stats-grid-modern {
    grid-template-columns: 1fr 1fr;
    gap: min(1rem, 2vw);
  }
  
  .activities-grid {
    grid-template-columns: 1fr;
    gap: min(1.5rem, 3vw);
  }
  
  .search-section {
    padding: min(1.5rem, 3vw);
  }
  
  .activities-table {
    min-width: min(600px, 100vw);
  }
  
  .activity-badges {
    flex-direction: column;
    gap: 0.5rem;
  }
  
  .status-badge,
  .priority-badge {
    width: 100%;
  }
}

/* Móviles pequeños */
@media (max-width: 480px) {
  .header-container {
    padding: 0 min(0.75rem, 1.5vw);
  }
  
  .actividades-container {
    padding: 1rem min(0.75rem, 1.5vw);
  }
  
  .gantt-header {
    padding: 0.5rem min(0.75rem, 1.5vw);
  }
  
  .gantt-left-panel {
    width: min(280px, 85vw);
  }
  
  .main-title {
    font-size: clamp(1.25rem, 6vw, 1.5rem);
  }
  
  .stats-grid-modern {
    grid-template-columns: 1fr;
    gap: min(1rem, 2vw);
  }
  
  .header-actions {
    flex-direction: column;
    gap: min(1rem, 2vw);
  }
  
  .btn-add-modern {
    width: 100%;
    justify-content: center;
  }
  
  .search-section {
    padding: min(1rem, 2vw);
  }
  
  .search-input {
    font-size: 16px; /* Previene zoom en iOS */
  }
  
  .activities-table {
    min-width: min(500px, 100vw);
  }
  
  .activity-card-content {
    padding: min(1.25rem, 2.5vw);
  }
  
  .filter-group-horizontal {
    flex-direction: column;
  }
}

/* Móviles extra pequeños */
@media (max-width: 375px) {
  .header-container,
  .actividades-container {
    padding-left: min(0.5rem, 1vw);
    padding-right: min(0.5rem, 1vw);
  }
  
  .gantt-header {
    padding: 0.5rem min(0.5rem, 1vw);
  }
  
  .gantt-left-panel {
    width: min(280px, 90vw);
  }
  
  .main-title {
    font-size: clamp(1.125rem, 7vw, 1.375rem);
  }
  
  .search-section {
    padding: min(0.75rem, 1.5vw);
  }
  
  .stat-card-modern {
    padding: min(1.25rem, 2.5vw);
  }
  
  .activity-card-content {
    padding: min(1rem, 2vw);
  }
  
  .activities-table {
    min-width: min(400px, 100vw);
  }
  
}

/* Pantallas extremadamente pequeñas */
@media (max-width: 320px) {
  .header-container,
  .actividades-container {
    padding-left: 0.5rem;
    padding-right: 0.5rem;
  }
  
  .gantt-header {
    padding: 0.5rem 0.5rem;
  }
  
  .gantt-left-panel {
    width: min(260px, 95vw);
  }
  
  .main-title {
    font-size: clamp(1rem, 8vw, 1.25rem);
  }
  
  .activities-table {
    min-width: min(350px, 100vw);
  }
  
}

/* ===== FIXES ADICIONALES DE SEGURIDAD ===== */

/* Prevenir overflow en cualquier elemento hijo */
.gantt-page *,
.actividades-page * {
  max-width: 100%;
  box-sizing: border-box;
}


.loading-spinner {
  max-width: none;
}


/* Para Firefox */
.gantt-timeline-weeks,
.gantt-timeline-content,
.activities-table-wrapper {
  -ms-overflow-style: none;
}

/* Optimización para pantallas con notch */
@supports (padding: max(0px)) {
  .header-container {
    padding-left: max(min(2rem, 4vw), env(safe-area-inset-left));
    padding-right: max(min(2rem, 4vw), env(safe-area-inset-right));
  }
  
  .actividades-container {
    padding-left: max(min(2rem, 4vw), env(safe-area-inset-left));
    padding-right: max(min(2rem, 4vw), env(safe-area-inset-right));
  }
  
  .gantt-header {
    padding-left: max(min(1rem, 2vw), env(safe-area-inset-left));
    padding-right: max(min(1rem, 2vw), env(safe-area-inset-right));
  }
}

/* Estados touch optimizados */
@media (max-width: 768px) {
  /* Aumentar áreas de toque */
  .gantt-back-btn,
  .back-btn-modern,
  .view-toggle-btn,
  .filter-btn {
    min-height: 44px;
    min-width: 44px;
  }
  
  .btn-add-modern {
    min-height: 44px;
  }
  
  /* Deshabilitar hover en touch */
  .activity-card-modern:hover,
  .stat-card-modern:hover {
    transform: none;
    box-shadow: initial;
  }
}

/* Animaciones suaves para cambios de layout */
.gantt-container,
.actividades-container,
.header-content,
.search-content {
  transition: all 0.3s ease;
}

/* Prevenir problemas de rendering */
.gantt-page,
.actividades-page {
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
  transform: translateZ(0);
}

/* Última medida de seguridad */
@media (max-width: 280px) {
  * {
    font-size: max(12px, 3vw) !important;
  }
  
  .main-title {
    font-size: max(16px, 4vw) !important;
  }
  
  .activities-table {
    min-width: 280px;
  }
}